import{j as e,r as o,Q as H,at as Q,W as U,aq as V,a7 as _,g as O,au as W,x as Z}from"./vendor-DcRwrwk9.js";import{c as f,B as J,P as K,g as X}from"./index-BEUX0Z6D.js";import{C as Y}from"./Checkbox-BoQFHUv_.js";import{L as ee}from"./Label-CEq3WBdJ.js";import{S as se,a as ae,b as te,c as ne,d as w}from"./Select-kEkG80sN.js";const A=({className:a,...t})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:f("mx-auto flex w-full justify-center",a),...t});A.displayName="Pagination";const $=o.forwardRef(({className:a,...t},n)=>e.jsx("ul",{ref:n,className:f("flex flex-row items-center gap-1",a),...t}));$.displayName="PaginationContent";const y=o.forwardRef(({className:a,...t},n)=>e.jsx("li",{ref:n,className:f("",a),...t}));y.displayName="PaginationItem";const b=({className:a,isActive:t,size:n="icon",...c})=>e.jsx(J,{"aria-current":t?"page":void 0,variant:t?"outline":"ghost",size:n,className:a,...c});b.displayName="PaginationLink";const D=({className:a,...t})=>e.jsxs(b,{"aria-label":"Go to previous page",size:"default",className:f("gap-1 pl-2.5",a),...t,children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]});D.displayName="PaginationPrevious";const k=({className:a,...t})=>e.jsxs(b,{"aria-label":"Go to next page",size:"default",className:f("gap-1 pr-2.5",a),...t,children:[e.jsx("span",{children:"Next"}),e.jsx(U,{className:"h-4 w-4"})]});k.displayName="PaginationNext";const F=({className:a,...t})=>e.jsxs("span",{"aria-hidden":!0,className:f("flex h-9 w-9 items-center justify-center",a),...t,children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"More pages"})]});F.displayName="PaginationEllipsis";const p="...",C=(a,t)=>{let n=t-a+1;return Array.from({length:n},(c,S)=>S+a)},ie=({totalCount:a,pageSize:t,siblingCount:n=1,currentPage:c})=>o.useMemo(()=>{const m=Math.ceil(a/t);if(n+5>=m)return C(1,m);const l=Math.max(c-n,1),j=Math.min(c+n,m),N=l>2,x=j<m-2,g=1,I=m;if(!N&&x){let h=3+2*n;return[...C(1,h),p,m]}if(N&&!x){let h=3+2*n,d=C(m-h+1,m);return[g,p,...d]}if(N&&x){let h=C(l,j);return[g,p,...h,p,I]}},[a,t,n,c])||[],M=X(),R=12;function me(){const{slug:a}=V(),t=_(),n=O(),[c,S]=o.useState([]),[m,E]=o.useState([]),[l,j]=o.useState(null),[N,x]=o.useState(!0),[g,I]=o.useState(0),h=o.useMemo(()=>new URLSearchParams(t.search),[t.search]),d=parseInt(h.get("page")||"1",10),L=h.get("sort")||"new",u=h.getAll("brand"),P=(s,i)=>{const r=new URLSearchParams(t.search);r.delete(s),Array.isArray(i)?i.forEach(v=>r.append(s,v)):i&&r.set(s,i),r.set("page","1"),n(`${t.pathname}?${r.toString()}`)};o.useEffect(()=>{async function s(){x(!0);try{const[i,r]=await Promise.all([M.categories.list(),M.products.list({categoryId:a==="all"||l==null?void 0:l.id,sort:L,brand:u.length>0?u:void 0})]);if(E(i),a!=="all"){const v=i.find(z=>z.slug===a);j(v||null)}else j({id:"all",slug:"all",name:"All Products"});S(r),I(r.length)}catch(i){console.error("Failed to fetch category data:",i)}finally{x(!1)}}s()},[a,l==null?void 0:l.id,L,u.join(",")]);const B=o.useMemo(()=>{const s=(d-1)*R;return c.slice(s,s+R)},[c,d]),T=ie({currentPage:d,totalCount:g,pageSize:R}),q=(s,i)=>{const r=i?[...u,s]:u.filter(v=>v!==s);P("brand",r)},G=o.useMemo(()=>[...new Set(c.map(s=>s.brand).filter(Boolean))],[c]);return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-4xl font-bold",children:(l==null?void 0:l.name)||"Shop"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Browse our collection of high-quality motorcycle gear."})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-8",children:[e.jsxs("aside",{className:"md:col-span-1",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(W,{className:"mr-2 h-5 w-5"})," Filters"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Category"}),e.jsx("ul",{className:"space-y-1",children:m.map(s=>e.jsx("li",{children:e.jsx("a",{href:`/category/${s.slug}`,className:`text-sm ${a===s.slug?"text-primary font-bold":"text-muted-foreground hover:text-foreground"}`,children:s.name})},s.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Brand"}),e.jsx("div",{className:"space-y-2",children:G.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Y,{id:`brand-${s}`,checked:u.includes(s),onCheckedChange:i=>q(s,!!i)}),e.jsx(ee,{htmlFor:`brand-${s}`,className:"text-sm font-normal",children:s})]},s))})]})]})]}),e.jsxs("main",{className:"md:col-span-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",B.length," of ",g," products"]}),e.jsxs(se,{value:L,onValueChange:s=>P("sort",s),children:[e.jsx(ae,{className:"w-[180px]",children:e.jsx(te,{placeholder:"Sort by"})}),e.jsxs(ne,{children:[e.jsx(w,{value:"new",children:"Newest"}),e.jsx(w,{value:"price-asc",children:"Price: Low to High"}),e.jsx(w,{value:"price-desc",children:"Price: High to Low"}),e.jsx(w,{value:"rating",children:"Top Rated"})]})]})]}),N?e.jsx("div",{className:"flex justify-center items-center h-96",children:e.jsx(Z,{className:"h-8 w-8 animate-spin"})}):B.length>0?e.jsxs(e.Fragment,{children:[e.jsx(K,{products:B}),e.jsx("div",{className:"mt-8",children:e.jsx(A,{children:e.jsxs($,{children:[e.jsx(y,{children:e.jsx(D,{href:"#",onClick:s=>{s.preventDefault(),d>1&&P("page",(d-1).toString())}})}),T.map((s,i)=>s===p?e.jsx(y,{children:e.jsx(F,{})},`${p}-${i}`):e.jsx(y,{children:e.jsx(b,{href:"#",isActive:s===d,onClick:r=>{r.preventDefault(),P("page",s.toString())},children:s})},s)),e.jsx(y,{children:e.jsx(k,{href:"#",onClick:s=>{s.preventDefault(),d<Math.ceil(g/R)&&P("page",(d+1).toString())}})})]})})})]}):e.jsxs("div",{className:"text-center py-20",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"No Products Found"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Try adjusting your filters."})]})]})]})]})}export{me as CategoryPage};
